{"version":3,"sources":["auth/local/index.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;;;uBAEO,SAAS;;;;wBACR,UAAU;;;;2BACP,iBAAiB;;AAEzC,IAAI,MAAM,GAAG,qBAAQ,MAAM,EAAE,CAAC;;AAE9B,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,UAAS,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE;AACxC,wBAAS,YAAY,CAAC,OAAO,EAAE,UAAS,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE;AACvD,QAAI,KAAK,GAAG,GAAG,IAAI,IAAI,CAAC;AACxB,QAAI,KAAK,EAAE;AACT,aAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KACpC;AACD,QAAI,CAAC,IAAI,EAAE;AACT,aAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,yCAAyC,EAAC,CAAC,CAAC;KACnF;;AAED,QAAI,CAAC,QAAQ,GAAG,SAAS,CAAC;AAC1B,QAAI,CAAC,IAAI,GAAG,SAAS,CAAC;AACtB,QAAI,KAAK,GAAG,4BAAU,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;;AAE3C,QAAI,CAAC,GAAG,CAAC,OAAO,EAAE;AAChB,SAAG,CAAC,OAAO,GAAG,EAAE,CAAC;KAClB;AACD,OAAG,CAAC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC;AACxB,OAAG,CAAC,OAAO,CAAC,KAAK,GAAG,KAAK,CAAC;AAC1B,WAAO,CAAC,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;AACzB,OAAG,CAAC,IAAI,CAAC,EAAE,KAAK,EAAL,KAAK,EAAE,CAAC,CAAC;GACrB,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,CAAA;CACnB,CAAC,CAAC;;qBAEY,MAAM","file":"auth/local/index.js","sourcesContent":["'use strict';\n\nimport express from 'express';\nimport passport from 'passport';\nimport {signToken} from '../auth.service';\n\nvar router = express.Router();\n\nrouter.post('/', function(req, res, next) {\n  passport.authenticate('local', function(err, user, info) {\n    var error = err || info;\n    if (error) {\n      return res.status(401).json(error);\n    }\n    if (!user) {\n      return res.status(404).json({message: 'Something went wrong, please try again.'});\n    }\n\n    user.password = undefined;\n    user.salt = undefined;\n    var token = signToken(user._id, user.role);\n\n    if (!req.session) {\n      req.session = {};\n    }\n    req.session.user = user;\n    req.session.token = token;\n    console.log(req.session);\n    res.json({ token });\n  })(req, res, next)\n});\n\nexport default router;\n"],"sourceRoot":"/source/"}